{"componentChunkName":"component---src-templates-template-tsx","path":"/finding-min-or-max-of-character-variables-in-sql/","result":{"data":{"site":{"meta":{"title":"Raw SAS - SAS Tips n Tricks","description":"Tips n Tricks and other SAS Titbits from around 10 years of SAS projects and tinkering about with SAS"}},"post":{"id":"3a2bac06-8b48-5099-a2bd-35eaee1366b0","html":"<p>It is perfectly valid to use <span style=\"font-family: 'courier new' , 'courier' , monospace;\">min()</span> as a <a href=\"http://support.sas.com/kb/25/279.html\" target=\"_blank\" rel=\"noopener\">summary function</a> on character values in <span style=\"font-family: 'courier new' , 'courier' , monospace;\">proc sql</span>, eg as follows:</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">proc</span></b> <b><span style=\"background: white; color: navy; font-family: 'courier new';\">sql</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">create</span> <span style=\"background: white; color: blue; font-family: 'courier new';\">table</span><span style=\"background: white; font-family: 'courier new';\"> test </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"><br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">  select</span><span style=\"background: white; font-family: 'courier new';\"> min(name) </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"> minval<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">from</span><span style=\"background: white; font-family: 'courier new';\"> sashelp.class;</span></blockquote>\n<p>This is not so, however, when using in an inline context:</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">proc</span></b> <b><span style=\"background: white; color: navy; font-family: 'courier new';\">sql</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">create</span> <span style=\"background: white; color: blue; font-family: 'courier new';\">table</span><span style=\"background: white; font-family: 'courier new';\"> test </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"><br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">select</span><span style=\"background: white; font-family: 'courier new';\"> min(name,sex) </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"> minval<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">from</span><span style=\"background: white; font-family: 'courier new';\"> sashelp.class;</span></blockquote>\n<p>Which gives:</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\">\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; color: red; font-family: 'courier new';\">ERROR: Function MIN requires a numeric expression as argument 1.</span></div>\n<div><span style=\"background: white; color: red; font-family: 'courier new';\">ERROR: Function MIN requires a numeric expression as argument 2.</span></div></blockquote>\n<div></div>\n<p>So what are the alternatives?  If we were in datastep, we might have had the option of the little-known<a href=\"http://support.sas.com/documentation/cdl/en/lrcon/62955/HTML/default/viewer.htm#a000780367.htm\" target=\"_blank\" rel=\"noopener\"> infix operator</a> for min (&gt;&lt;):</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\">\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">data</span></b> <span style=\"background: white; color: blue; font-family: 'courier new';\">_null_</span><span style=\"background: white; font-family: 'courier new';\">;</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: 'courier new';\">  minval=</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'Less'</span><span style=\"background: white; font-family: 'courier new';\">&gt;&lt;</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'More'</span><span style=\"background: white; font-family: 'courier new';\">&gt;&lt;</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'Lots'</span><span style=\"background: white; font-family: 'courier new';\">;</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">put</span><span style=\"background: white; font-family: 'courier new';\"> minval=;  </span><span style=\"background: white; color: green; font-family: 'courier new';\">/* minval=Less */</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">run</span></b><span style=\"background: white; font-family: 'courier new';\">;</span></div></blockquote>\n<p>As it happens though, the min &amp; max infix operators are not valid in proc sql.  Another approach, if comparing just two values, would be <span style=\"font-family: 'courier new' , 'courier' , monospace;\">ifc()</span> - eg:</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">proc</span></b> <b><span style=\"background: white; color: navy; font-family: 'courier new';\">sql</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">create</span> <span style=\"background: white; color: blue; font-family: 'courier new';\">table</span><span style=\"background: white; font-family: 'courier new';\"> test </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as<br/>\n</span><span style=\"background: white; font-family: 'courier new';\"> </span>  <span style=\"background: white; color: blue; font-family: 'courier new';\">select</span><span style=\"background: white; font-family: 'courier new';\"> ifc(name&lt;sex,name,sex) </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"> minval<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">from</span><span style=\"background: white; font-family: 'courier new';\"> sashelp.class;</span></blockquote>\n<p>But what if we have more than two values?  In this instance, it becomes necessary to take matters into your own hands!  I've gone ahead and rolled up an FCMP function below, which could surely be improved, but does the job when comparing three character values in either data step or proc sql:</p>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: 'courier new';\">proc</span></b> <b><span style=\"background: white; color: navy; font-family: 'courier new';\">fcmp</span></b> <span style=\"background: white; color: blue; font-family: 'courier new';\">outlib</span><span style=\"background: white; font-family: 'courier new';\">=work.myfuncs.test;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">function</span><span style=\"background: white; font-family: 'courier new';\"> minC(a $, b $, c $) $;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">    </span><span style=\"background: white; color: blue; font-family: 'courier new';\">length</span><span style=\"background: white; font-family: 'courier new';\"> result $</span><b><span style=\"background: white; color: teal; font-family: 'courier new';\">1000</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">    result=a&gt;&lt;b&gt;&lt;c;</span><span style=\"background: white; font-family: 'courier new';\"><br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">    return</span><span style=\"background: white; font-family: 'courier new';\"> (result);<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">endsub</span><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><b><span style=\"background: white; color: navy; font-family: 'courier new';\">quit</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">options</span> <span style=\"background: white; color: blue; font-family: 'courier new';\">cmplib</span><span style=\"background: white; font-family: 'courier new';\">=work.myfuncs;<br/>\n</span><b><span style=\"background: white; color: navy; font-family: 'courier new';\">data</span></b> <span style=\"background: white; color: blue; font-family: 'courier new';\">_null_</span><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">x</span><span style=\"background: white; font-family: 'courier new';\">=</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'Killing'</span><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  y=</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'Me'</span><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  z=</span><span style=\"background: white; color: purple; font-family: 'courier new';\">'Softly'</span><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  outvar=minC(x,y,z);</span><span style=\"background: white; font-family: 'courier new';\"><br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">  put</span><span style=\"background: white; font-family: 'courier new';\"> outvar=;<br/>\n</span><b><span style=\"background: white; color: navy; font-family: 'courier new';\">run</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><b><span style=\"background: white; color: navy; font-family: 'courier new';\">proc</span></b> <b><span style=\"background: white; color: navy; font-family: 'courier new';\">sql</span></b><span style=\"background: white; font-family: 'courier new';\">;<br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">create</span> <span style=\"background: white; color: blue; font-family: 'courier new';\">table</span><span style=\"background: white; font-family: 'courier new';\"> test </span><span style=\"background: white; color: blue; font-family: 'courier new';\">as</span><span style=\"background: white; font-family: 'courier new';\"><br/>\n</span><span style=\"background: white; color: blue; font-family: 'courier new';\">  select</span><span style=\"background: white; font-family: 'courier new';\"> minC(name,sex)<br/>\n</span><span style=\"background: white; font-family: 'courier new';\">  </span><span style=\"background: white; color: blue; font-family: 'courier new';\">from</span><span style=\"background: white; font-family: 'courier new';\"> sashelp.class;</span></blockquote>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"></div>\n&nbsp;\n<div></div>\n<p>Would you deal with the requirement any differently?  Let me know in the comments!</p>","frontmatter":{"title":"Find MIN / MAX of character variables in sql","path":"/finding-min-or-max-of-character-variables-in-sql/","previewImg":null,"tags":["SQL"],"date":"Nov 27, 2017"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3}}},"staticQueryHashes":[]}