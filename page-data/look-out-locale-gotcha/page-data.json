{"componentChunkName":"component---src-templates-template-tsx","path":"/look-out-locale-gotcha/","result":{"data":{"site":{"meta":{"title":"Raw SAS - SAS Tips n Tricks","description":"Tips n Tricks and other SAS Titbits from around 10 years of SAS projects and tinkering about with SAS"}},"post":{"id":"c2e8e31e-0a66-568f-bcbe-89180ce992d6","html":"<p>As gotcha’s go, this was a good one!</p>\n<p>We had a report being generated with dates that were inconsistent with the source file (MMDDYY instead of DDMMYY), but only for certain records.  This was definitely related to the <span style=\"font-family: 'courier new' , 'courier' , monospace;\">ANYDTDTE</span>. informat, but the strange thing was - this issue only occurred when the report was generated by the Stored Process Server (it was fine in batch).</p>\n<p>The <span style=\"font-family: 'courier new' , 'courier' , monospace;\">ANYDTDTE</span>. informat is driven by the locale setting but as per the chain of sasv9.cfg files we had <span style=\"font-family: Courier New, Courier, monospace;\">-LOCALE en_GB</span><span style=\"font-family: courier new, courier, monospace;\"> </span><span style=\"font-family: inherit;\">defined for</span> both servers.  So I checked the logs, and found something interesting..</p>\n<p>One of our STP applications can be triggered from either Excel or a browser.  I could see that the same user had triggered two requests, less than a minute apart, one from excel and one from a browser (as evidenced by the value of the _HTUA variable)</p>\n<p>Yet one session had <span style=\"font-family: 'courier new' , 'courier' , monospace;\">_USERLOCALE=en<em>US</span> and the other had <span style=\"font-family: 'courier new' , 'courier' , monospace;\">\\</em>USERLOCALE=en_GB</span>!!</p>\n<p>As it turns out, the locale for a Stored Process session <i>can change according to the context of the client</i> - as described in this <a href=\"http://support.sas.com/kb/45/414.html\" target=\"_blank\" rel=\"noopener\">usage note</a>.</p>\n<p>So the fix is simply to add the following code (as per your desired locale):</p>\n<blockquote><span style=\"font-family: 'courier new' , 'courier' , monospace;\">options locale=en_gb;</span></blockquote>\nBut where?\n<p>I tried fixing this via the autoexec, but this had no effect (likely because the server is running before the request arrives) so instead I added it to the stp init program - which worked a treat.\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.595744680851062%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABIElEQVQY0z2QWU/CUBBG+f//yBijiUZZStna0t62t/sC3YWCb8cLGh5OZuZlZs43MTwfUwZsHJe147HzA6wwYavqxpM4xRGnrAjanvR7JD9fFFeK8edBOV7JTyNJNzCxhYf0JVVVEUcxQggCKe9I38MTDtJzEfaeKI44XS70XUfTNHRto/r2wW2eJElKqsiyjDAM0TcGy63FynDQdw7aDdNnacestDX68xNSHev7nmPVkBYHkn8Odcsky3LSVC1NM4Ig4HNpMFvvmeoW75rJh2agWwFmVLG3fOYvr3zNFoznE1FZMxcpC5EwVQdF3vwtLIqCsiyJlPItAldpW5aldG1WIuPNHpi6LYPKKVdfLTSdQX3Y1LXSbO8R9H1Hp7R/Abuiav9vnShGAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 300x79\" title=\"Capture 300x79\" src=\"/tetrahex-rawsas/static/30f4d55f64791cc5630df4113fca45a1/5a46d/Capture-300x79.png\" srcset=\"/tetrahex-rawsas/static/30f4d55f64791cc5630df4113fca45a1/4dcb9/Capture-300x79.png 188w,\n/tetrahex-rawsas/static/30f4d55f64791cc5630df4113fca45a1/5a46d/Capture-300x79.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<b>I recommend adding this to your init program</b>, unless you really do want your outputs to change according to the locale setting of the client application!</p>\n<div style=\"clear: both; text-align: center;\"></div>","frontmatter":{"title":"Look out - Locale Gotcha","path":"/look-out-locale-gotcha/","previewImg":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9UlEQVQY0zWO226DMBiDef8n2lRN01QJqS1twxmSHxJIIJwTKmDsbmmnWZ994QvLVpDlYU49DAiTIKcx4x7kXkax7FLZ0UmLxyrXb7nuzfZjaF80yybUbKWQMcr6fuAlBwDGWEEpzbKMEJOAU875sm1aqWkctZpmrf4whSWqp4QQBWPIj1GI3QhQBLcQbjG7Y+He/PvHwWzOs+6Gkcu2rBtDO06WlLU0rmvOxfGMbMe3neDr5B0vHkqKiPVRBPbb++WKtnUpm8EhlUPECQsiJ6v+lxBVnGDAJEmSnKSI1J/RdAa17TtvuitytVbDMLye68f8PP4L8oQIPXt4nQcAAAAASUVORK5CYII=","aspectRatio":3.7735849056603774,"src":"/tetrahex-rawsas/static/e4e610369faede071a7330a17d396eb6/0b66b/frontmatter16.png","srcSet":"/tetrahex-rawsas/static/e4e610369faede071a7330a17d396eb6/69585/frontmatter16.png 200w,\n/tetrahex-rawsas/static/e4e610369faede071a7330a17d396eb6/497c6/frontmatter16.png 400w,\n/tetrahex-rawsas/static/e4e610369faede071a7330a17d396eb6/0b66b/frontmatter16.png 709w","sizes":"(max-width: 709px) 100vw, 709px"}}},"tags":["sas","SAS Stored Process Web Application","Stored Process Web Applications","Web Applications"],"date":"Dec 12, 2016"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3}}},"staticQueryHashes":[]}