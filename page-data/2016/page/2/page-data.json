{"componentChunkName":"component---src-templates-post-list-template-tsx","path":"/2016/page/2","result":{"data":{"site":{"meta":{"title":"Raw SAS - SAS Tips n Tricks","description":"Tips n Tricks and other SAS Titbits from around 10 years of SAS projects and tinkering about with SAS"}},"remark":{"posts":[{"post":{"html":"<p>Having been blessed with an en-dash (alt + 2013) in our TFS project root, I’ve been having lots of fun getting SAS to ‘play nicely’ with non-ascii characters when running OS commands (eg tf.exe).<br /><br />Storing the values in macro variables works fine for direct use (eg in an X command), but running a SAS generated .bat file was proving challenging - until I realised that the issue was actually within the windows shell, rather than SAS itself.<br /><br />The solution turned out to be twofold.  Firstly, the batch file itself needed to be UTF-8 encoded WITHOUT the BOM marker.  This required the <span style=\"background-color: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span>  system <a href=\"http://support.sas.com/documentation/cdl/en/nlsref/61893/HTML/default/viewer.htm#a003105792.htm\" target=\"_blank\">option</a> to be in place before creating the file.<br /><br />Secondly, the shell needs to be configured to read UTF-8 characters.  This can be done by changing the codepage (using  <span style=\"background-color: #eff0f1; color: #242729; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif; font-size: 13px; white-space: inherit;\">chcp 65001</span>) and <a href=\"http://rawsas.blogspot.co.uk/2016/08/chaining-windows-commands-in-sas.html\" target=\"_blank\">chaining</a> with an ampersand.<br /><br />Sample code as follows:<br /><blockquote style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> work=</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%sysfunc</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">(pathname(work));<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> file=&#x26;work/mybatchfile.bat;</span></blockquote>         <b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">file</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">”&#x26;file”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">encoding</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘utf-8’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“dir \"\"&#x26;work\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘echo Nonstandard – Dash’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">run</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">    filename</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“chcp 65001 &#x26; \"\"&#x26;file\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">data</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><br /><div></div><br /></p>","frontmatter":{"title":"Reading UTF-8 in Filename Pipe","path":"/reading-utf-8-in-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Sep 06, 2016"}}},{"post":{"html":"<p>There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href=\"http://blogs.sas.com/content/sasdummy/tag/powershell/\" target=\"_blank\">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just <b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I’m going to split the example over three lines:</div><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$uri</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">”<a href=\"http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do%22\">http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do”</a></span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$pgm</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">“/Products/SAS Intelligence Platform/Samples/Sample: Hello World”</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">invoke-webrequest</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"> <span style=\"color: navy;\">-Uri</span> <span style=\"color: darkred;\">”</span>$(<span style=\"color: orangered;\">$uri</span>)<span style=\"color: darkred;\">?_program=</span><span style=\"color: orangered;\">$pgm</span><span style=\"color: darkred;\">”</span> <span style=\"color: navy;\">-UseDefaultCredentials</span></span></div></blockquote>Which gives the response:<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"./images/Capture.PNG\" style=\"margin-left: 1em; margin-right: 1em;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.2127659574468%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACjUlEQVQoz2VSCVPaUBB+eCHUYpWptiJHQkAIpxAIl8ihooC0SMKRICJHAJEKyuHRmU7/eTfB0U47882bfcfuft+3D1mTd47UvfNs7M1M7ccj7LBviN76szMyOXQcj6jMJJCbUbkZFr2lzqdUduI8ufekxwAiNkBq95XadfV5v75IFBHGKKzcmo1HujzCCrBFhgLSX4jr/4DbeP4pXfrpTAy0vuaW9xoL9fxnI7mlvGQuL++9ofIWr1gqC6bSHGjdVdt012RGVkaUkJHdcNXz1V+OeH/X3yYiXS3d0tKChmruUE2tr6Whm8RBb9lcQkRRBkwRziKcgWgBNjijctTy1d/UyXDb29AHhF1fC+jA7aKptCh1E1cpU0yWvUbiEXRWWnk6/YCFBUSwC6bXQwmMxK74NxAW7hmCArASNRhZ9X6DPOxjQYGI3Nhit2u2qspe/WivrjsuV/bKoklSrXkhJLdyKxbRCYk2q3bXD3KT5MVj9Ns0lpu5j+4ShcdU8dkW639y1lSOy/dCRtA8ZwWaoTPGbFHNRP6JSg2DmTF9dh/7/njMPIfSY29q5DsdeU9HGrq17blWWjmxMwx2SRQmJeMM+BTMTOzJgT/7YAp3tIG2xtdcIzmEgQVFGXSDsQPAZpAQyE4dyQFEMskbjb/tPRmaIj3zYR+msgn/x3NtCHWwcFdHt4GwNiBgIeEr1cAjXWQ/+mGN3Xyw8SAb6sEdGR+obLzSzq+SnPgr9soKkocHcktlyVxSkJyS5FetFThBicJL+HysCwpyGL2+sOtvfaEa8L1AFShSQBWSgy0oEh2aTw5nX9d44eWIfQJvTJHutqeuC3RcybsdXxOP9gzhjiHS0QfbG64aPP1nyIA/fYm1iR5ij54AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1\" title=\"Capture 1\" src=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png\" srcset=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/4dcb9/Capture_1.png 188w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/5ff7e/Capture_1.png 375w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></a></div><br />The key part to this request, to avoid HTTP Status 401 and “This request requires HTTP authentication” response, is the <span style=\"background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;\">-UseDefaultCredentials </span>parameter.  This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output </li><li>You may need to set your execution policy (explained <a href=\"http://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/\" target=\"_blank\">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul><br /><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><br /></div></blockquote></p>","frontmatter":{"title":"Invoking Stored Processes with Powershell - the easy way","path":"/invoking-stored-processes-with-powershell-the-easy-way/","previewImg":null,"tags":["SQL"],"date":"Aug 31, 2016"}}},{"post":{"html":"<p>Using <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">filename pip</span>e (instead of the <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">X</span> command, or <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">call execute</span>) is a great way to submit OS commands, not least because the standard output can be read directly into SAS.<br /><br />But how does one submit multiple commands in the same filename (or file) statement?<br /><br />Easy - &#x26; I’ll show you how:<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> <span style=\"color: purple;\">“D: &#x26; cd \"\"%sysfunc(pathname(work))\"\" &#x26; dir” </span></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><br />The above snippet opens a shell (via the pipe fileref), changes the working directory to the D drive, then to the work folder (our work location is on a different drive), then executed the dir command to demonstrate that we are indeed in the work folder.<br /><br />The delimiter is, of course, the ampersand (&#x26;).</p>","frontmatter":{"title":"Chaining Windows Commands in SAS Filename Pipe (&)","path":"/chaining-windows-commands-in-sas-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Aug 09, 2016"}}},{"post":{"html":"<p>Currently working on putting our SAS deployment process into TFS and Release Management - part of which involves creating a ‘build’ in Visual Studio.<br /><br />The below caused a build failure, and didn’t come up in google:<br /><blockquote><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\"><br /></span><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">Exception Message: The build controller Visual Studio Controller - internal-svr-name does not contain an enabled build agent with name * and no tags. (type SoapException)SoapException Details: &#x3C;soap:Detail xmlns:soap=”<a href=\"http://www.w3.org/2003/05/soap-envelope\">http://www.w3.org/2003/05/soap-envelope</a>” /></span></blockquote><br />The fix was very straightforward (presuming you are using a Default Template).  In Visual Studio, simply open your build definition, in the ‘Process’ section, under ‘5.Advanced’ expand ‘Agent Settings’ and set your Tag comparison operator to ‘MatchAtLeast’ (instead of MatchExactly):<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"/tetrahex-rawsas/27bddd216c56524ef4829a50eab7038b/Capture_2.png\" style=\"margin-left: 1em; margin-right: 1em;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.893617021276595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAfElEQVQI123G0QqCMBQA0P3/PwVBhPkk9lASiBXWam6Zd3dz04u3wNfBeThCq5dRchodBbdQZKaUBRG07hAtWgAY+o/xDsXNhPIOlfQnOZ7fse454ctXZVVnfCQXVvP/4tj6bTUUDyok5y0fUvIn7y6wKeW+DlkzZ820+gG15aaVjhA4NgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 3\" title=\"Capture 3\" src=\"/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/6af66/Capture_3.png\" srcset=\"/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/4dcb9/Capture_3.png 188w,\n/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/5ff7e/Capture_3.png 375w,\n/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/6af66/Capture_3.png 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></a></div><br /></p>","frontmatter":{"title":"Visual Studio Build Controller does not contain an enabled build agent with name * and no tags.","path":"/visual-studio-build-controller-does-not-contain-an-enabled-build-agent-with-name-and-no-tags/","previewImg":null,"tags":["SQL"],"date":"Jul 29, 2016"}}},{"post":{"html":"<p>Having a list of domain users and associated properties can be useful for a number of reasons:<br /><br /><ul><li>Identifying joiners / leavers</li><li>Getting a list of employees</li><li>Converting usernames into email addresses</li><li>Alerting administrators when accounts are locked out</li></ul><div>Below is an approach for obtaining those users, producing a SAS dataset that could serve in a DI job for staging a database table.</div><div><blockquote style=\"margin-bottom: 0.0001pt;\"><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/_ set up command via pipe fileref <em>/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">noquotelenmax</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">filename</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> process </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“powershell \"\"Get-ADUser -Filter {enabled -eq $True} -properties Title,LockedOut,Created,Department,EmailAddress</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">  |Select-Object SamAccountName,Name,GivenName,Surname,UserPrincipalName,DistinguishedName,Title,LockedOut,created,Department,EmailAddress</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">  |Export-CSV  ‘%sysfunc(pathname(work))ad</em>users.csv’ \"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><br /></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/* execute command and capture any output from the shell <em>/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> process; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <span style=\"color: blue;\">list</span></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><br /></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/</em> load CSV into SAS dataset */</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> AD<em>USERS;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“%sysfunc(pathname(work))ad</em>users.csv”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">dsd</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">firstobs</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">3</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">lrecl</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">10000</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> SamAccountName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> name:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> GivenName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    SurName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> UserPrincipalName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$200.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    DistinguishedName:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$500.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> Title:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> LockedOut:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$5.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    created:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$25.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> Department:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$50.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EmailAddress:</span><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">$100.</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">if</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> index(DistinguishedName,</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘OU=Employees’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">then</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EMPLOYEE<em>FLG=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">1</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">else</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> EMPLOYEE</em>FLG=</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">0</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div></blockquote><div></div></div><div><br /></div><div>This will extract all ACTIVE accounts (enabled eq $True) with some selected additional properties (more <a href=\"http://social.technet.microsoft.com/wiki/contents/articles/12037.active-directory-get-aduser-default-and-extended-properties.aspx\" target=\"_blank\">here</a>).  Some conditional logic is applied to distinguish employees from service accounts.</div><div><br /><div>Prerequisites:</div><div><ul><li>X Command enabled (see <a href=\"http://support.sas.com/kb/15/179.html\" target=\"_blank\">here </a>for instructions, is similar process for workspace servers)</li><li>Powershell installed</li></ul></div></div><div>Enjoy!</div><div><br /></div><div><br /></div></p>","frontmatter":{"title":"Extracting Active Directory accounts into SAS using Powershell","path":"/extracting-active-directory-accounts-into-sas-using-powershell/","previewImg":null,"tags":["sas powershell ad-users windows domain accounts"],"date":"Jun 22, 2016"}}},{"post":{"html":"<p>Converting a SAS date or datetime to javascript isn’t hard, but still - it should be easy to google for!</p>\n<p><span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtSAS=20563;</span>\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtJS=new Date(+new Date(1960,0,1) + dtSAS * 86400000);</span>\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  alert(dtJS.toUTCString());</span></p>\n<p>Right, that should get rid of 95% of readers, for the rest of you, a quick explanation.</p>\n<p>First, it’s important to note that SAS dates are stored as number of <i>days </i>since Jan 1st, 1960 - whereas Javascript “dates” are actually the number of <i>milliseconds </i>since Jan 1st 1970.  This explains the <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">86400000 </span>value (24 days _ 60 minutes _ 60 seconds * 1000 milliseconds), and why the embedded <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Date() </span>object is set to 1960.</p>\n<p>Next, there’s the ”+” sign before that nested Date object.  That tells Javascript to return a numeric value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">-315619200000</span>) instead of a formatted value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Fri Jan 01 1960 00:00:00 GMT+0000 (GMT Standard Time)</span>).</p>\n<p>Finally, the .toUTCString() method avoids contention with local time conventions (eg the extra 1 hour in BST).</p>\n<p>To make this even easier to deal with, I’ve knocked together a simple Javascript function - see <a href=\"https://jsfiddle.net/rawsas/bzskug3d/\" target=\"_blank\" rel=\"noopener\">fiddle</a>.</p>\n<div style=\"clear: both; text-align: center;\"></div>\n<span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// valid in ECMASCRIPT 2016</span>\n<span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAS</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// accepts SAS unformatted DATE or DATETIME</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// dtType should be used to determine the above</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// -315619200000 is equivalent to +new Date(1960,0,1)</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// 86400000 is equivalent to 24h * 60m * 60s * 1000ms</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">86400000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    console.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">log</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'Unknown dtType value - '</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtType</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #003366; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">null</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span>\n<span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">20578</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1776743820</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<p>If this post was useful, then do also check out <a href=\"/tetrahex-rawsas/building-web-apps-with-sas\">How To Build Web Apps With SAS</a>.</p>\n<p>And in case you were wondering - datetime <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: x-small;\">1776743820 </span>(GMT) was when Dr Goodnight officially <a href=\"http://www.linkedin.com/hp/update/6128386230842384384\" target=\"_blank\" rel=\"noopener\">announced </a>SAS Viya!</p>","frontmatter":{"title":"Converting SAS date to Javascript datetime (in Javascript)","path":"/converting-sas-date-to-javascript-date-in-javascript/","previewImg":null,"tags":["SQL"],"date":"May 04, 2016"}}},{"post":{"html":"<p>Thought I’d write this one up as the exact error message didn’t appear on google.  Of course, the sharp eyed among you will quickly spot the missing security / authorisation info..<br /><br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15         LIBNAME myLib OLEDB PROPERTIES=(‘initial catalog’=MyCat) DATASOURCE=‘MySvr’ PROVIDER=SQLNCLIxx.x SCHEMA=dbo</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15       ! connection=shared;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error trying to establish connection: Unable to Initialize: Invalid authorization specification</span></div><br /><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error in the LIBNAME statement.</span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background-color: white;\">The fix was to provide a valid connection string, eg as follows (in this particular case):</span></div><div><span style=\"background-color: white;\"><br /></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">LIBNAME</span><span style=\"background: white; font-family: 'Courier New';\"> myLib </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">OLEDB</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROPERTIES</span><span style=\"background: white; font-family: 'Courier New';\">=(</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Integrated Security’</span><span style=\"background: white; font-family: 'Courier New';\">=SSPI </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Persist Security Info’</span><span style=\"background: white; font-family: 'Courier New';\">=True </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘initial catalog’</span><span style=\"background: white; font-family: 'Courier New';\">=MyCat) </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">DATASOURCE</span><span style=\"background: white; font-family: 'Courier New';\">=</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘MySrv’</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROVIDER</span><span style=\"background: white; font-family: 'Courier New';\">=SQLNCLIxx.x  </span></div><div> </div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">SCHEMA</span><span style=\"background: white; font-family: 'Courier New';\">=dbo </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">connection</span><span style=\"background: white; font-family: 'Courier New';\">=shared;</span></div><div><span style=\"background-color: white;\"><br /></span></div><div><span style=\"background-color: white;\">Given that this libname statement was being built <a href=\"https://github.com/sashub/macro/blob/master/standalone/assign_direct_lib.sas\" target=\"_blank\">dynamically</a> from metadata, it was necessary to stick those properties into the server definition, as follows:</span></div><div></div><ol><li>Open SMC</li><li>Expand Server Manager</li><li>Expand the relevant Server (as specified in the Library definition)</li><li>In the properties of the underlying Connection, select the Options tab</li><li>Select OLE DB Connection Information Options</li><li>Stick in the relevant properties as per the libname statement, <i>including brackets</i>.</li></ol></p>","frontmatter":{"title":"Error trying to establish connection: Unable to Initialize: Invalid authorization specification","path":"/error-trying-to-establish-connection-unable-to-initialize-invalid-authorization-specification/","previewImg":null,"tags":["SQL"],"date":"Jan 23, 2016"}}}]}},"pageContext":{"page":"year","archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3},"filter":{"frontmatter":{"date":{"gte":"2016","lt":"20161"}}},"limit":10,"skip":10,"numPages":2,"currentPage":2,"year":"2016"}},"staticQueryHashes":[]}