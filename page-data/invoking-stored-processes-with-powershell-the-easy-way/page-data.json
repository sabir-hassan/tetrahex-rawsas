{"componentChunkName":"component---src-templates-template-tsx","path":"/invoking-stored-processes-with-powershell-the-easy-way/","result":{"data":{"site":{"meta":{"title":"Raw SAS - SAS Tips n Tricks","description":"Tips n Tricks and other SAS Titbits from around 10 years of SAS projects and tinkering about with SAS"}},"post":{"id":"058dff96-59ce-5cf9-8016-115f72cb6b9e","html":"<p>There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href=\"http://blogs.sas.com/content/sasdummy/tag/powershell/\" target=\"_blank\">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just <b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I’m going to split the example over three lines:</div><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$uri</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">”<a href=\"http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do%22\">http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do”</a></span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$pgm</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">“/Products/SAS Intelligence Platform/Samples/Sample: Hello World”</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">invoke-webrequest</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"> <span style=\"color: navy;\">-Uri</span> <span style=\"color: darkred;\">”</span>$(<span style=\"color: orangered;\">$uri</span>)<span style=\"color: darkred;\">?_program=</span><span style=\"color: orangered;\">$pgm</span><span style=\"color: darkred;\">”</span> <span style=\"color: navy;\">-UseDefaultCredentials</span></span></div></blockquote>Which gives the response:<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"./images/Capture.PNG\" style=\"margin-left: 1em; margin-right: 1em;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.2127659574468%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACjUlEQVQoz2VSCVPaUBB+eCHUYpWptiJHQkAIpxAIl8ihooC0SMKRICJHAJEKyuHRmU7/eTfB0U47882bfcfuft+3D1mTd47UvfNs7M1M7ccj7LBviN76szMyOXQcj6jMJJCbUbkZFr2lzqdUduI8ufekxwAiNkBq95XadfV5v75IFBHGKKzcmo1HujzCCrBFhgLSX4jr/4DbeP4pXfrpTAy0vuaW9xoL9fxnI7mlvGQuL++9ofIWr1gqC6bSHGjdVdt012RGVkaUkJHdcNXz1V+OeH/X3yYiXS3d0tKChmruUE2tr6Whm8RBb9lcQkRRBkwRziKcgWgBNjijctTy1d/UyXDb29AHhF1fC+jA7aKptCh1E1cpU0yWvUbiEXRWWnk6/YCFBUSwC6bXQwmMxK74NxAW7hmCArASNRhZ9X6DPOxjQYGI3Nhit2u2qspe/WivrjsuV/bKoklSrXkhJLdyKxbRCYk2q3bXD3KT5MVj9Ns0lpu5j+4ShcdU8dkW639y1lSOy/dCRtA8ZwWaoTPGbFHNRP6JSg2DmTF9dh/7/njMPIfSY29q5DsdeU9HGrq17blWWjmxMwx2SRQmJeMM+BTMTOzJgT/7YAp3tIG2xtdcIzmEgQVFGXSDsQPAZpAQyE4dyQFEMskbjb/tPRmaIj3zYR+msgn/x3NtCHWwcFdHt4GwNiBgIeEr1cAjXWQ/+mGN3Xyw8SAb6sEdGR+obLzSzq+SnPgr9soKkocHcktlyVxSkJyS5FetFThBicJL+HysCwpyGL2+sOtvfaEa8L1AFShSQBWSgy0oEh2aTw5nX9d44eWIfQJvTJHutqeuC3RcybsdXxOP9gzhjiHS0QfbG64aPP1nyIA/fYm1iR5ij54AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1\" title=\"Capture 1\" src=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png\" srcset=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/4dcb9/Capture_1.png 188w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/5ff7e/Capture_1.png 375w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></a></div><br />The key part to this request, to avoid HTTP Status 401 and “This request requires HTTP authentication” response, is the <span style=\"background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;\">-UseDefaultCredentials </span>parameter.  This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output </li><li>You may need to set your execution policy (explained <a href=\"http://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/\" target=\"_blank\">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul><br /><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><br /></div></blockquote></p>","frontmatter":{"title":"Invoking Stored Processes with Powershell - the easy way","path":"/invoking-stored-processes-with-powershell-the-easy-way/","previewImg":null,"tags":["SQL"],"date":"Aug 31, 2016"}}},"pageContext":{"archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3}}},"staticQueryHashes":[]}