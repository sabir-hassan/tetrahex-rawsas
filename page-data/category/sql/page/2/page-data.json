{"componentChunkName":"component---src-templates-post-list-template-tsx","path":"/category/sql/page/2","result":{"data":{"site":{"meta":{"title":"Raw SAS - SAS Tips n Tricks","description":"Tips n Tricks and other SAS Titbits from around 10 years of SAS projects and tinkering about with SAS"}},"remark":{"posts":[{"post":{"html":"<p>If you are getting the following message when importing a package containing a FLOW:</p>\n<div>\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; text-autospace: none;\"><span style=\"font-size: 10pt;\"><span style=\"font-family: &apos;courier new&apos; , &apos;courier&apos; , monospace;\">ERROR - An error occurred trying to connect the responsible parties for the imported objects.&#xA0; Reason: Can&apos;t find resource for bundle java.util.PropertyResourceBundle, key ResponsiblePartyHandler.InvalidSearchAttrib.txt</span></span></blockquote>\nThen as per this <a href=\"http://support.sas.com/kb/48/429.html\" target=\"_blank\" rel=\"noopener\">usage note</a>, and as I just verified locally, it is because the&#xA0;<b>Responsibilities </b>metadata is not imported. &#xA0;So if you set your flow properties as follows:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 10.106382978723403%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAdUlEQVQI1zWNUQ7DIAxDe/9LrUcoFV9lYggCJQgJwQW8pNo+rDgvsbxdl4O1Fsdh4P0HOWfcd0WtLKrg1pASwZgTpRQw8+/G4htI/mOMD9d9671jjIG1lgQT9tcO594SziCiR8q99yCZf6bS8hACTilTP+fEFygjkig0Fe/LAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 300x31\" title=\"Capture 300x31\" src=\"/tetrahex-rawsas/static/d8e9cd0dcaaf0eae6ef2d4dc51f03d8c/5a46d/Capture-300x31.png\" srcset=\"/tetrahex-rawsas/static/d8e9cd0dcaaf0eae6ef2d4dc51f03d8c/4dcb9/Capture-300x31.png 188w,\n/tetrahex-rawsas/static/d8e9cd0dcaaf0eae6ef2d4dc51f03d8c/5a46d/Capture-300x31.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nYou will see that after export / import the metadata is gone:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 12.765957446808512%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAdElEQVQI13WMuwrEIBBF/f8/2zRJYaqwlVFxfIBJlQW9cQohYHbgMHBfYp4XTJ8J2/YFkYdzNMD6rjWkXKHUDvIvOeLvIIwxYLSxrUgIIcC3whPWrLVtULZBhRjjkOmInDPO80BKCdf1Q60VpZQB1vn++Z0bt27isfLXcpwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture2 300x39\" title=\"Capture2 300x39\" src=\"/tetrahex-rawsas/static/761f760164c5d2c6e82808f6063a5eae/5a46d/Capture2-300x39.png\" srcset=\"/tetrahex-rawsas/static/761f760164c5d2c6e82808f6063a5eae/4dcb9/Capture2-300x39.png 188w,\n/tetrahex-rawsas/static/761f760164c5d2c6e82808f6063a5eae/5a46d/Capture2-300x39.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nThe metadata therefore has to be manually added back following the import. &#xA0;In our case, we never use this field, and the <span style=\"font-family: &apos;courier new&apos; , &apos;courier&apos; , monospace;\">ERROR </span>has not caused any problems thus far (many &apos;00s of flow deployments). &#xA0;Still, if anyone has any tips for avoiding the <span style=\"font-family: &apos;courier new&apos; , &apos;courier&apos; , monospace;\">ERROR </span>do please advise!</div>","frontmatter":{"title":"Importing flow: ERROR - An error occurred trying to connect the responsible parties for the imported objects.","path":"/importing-flow-error-an-error-occurred-trying-to-connect-the-responsible-parties-for-the-imported-objects-reason-cant-find-resource-for-bundle-java-util-propertyresourcebundle-key-responsiblep/","previewImg":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsSAAALEgHS3X78AAAAXElEQVQI102MwQqAIBAF+/9fy9MSejANFdTdEATt3kMImtPwGN5m7am1Jjq8u1JKOee6YOYYIxGVUuoHRgTOeWzwrbXWex9jIFW7CiHKLbxAjTv+ISL4MsbAnjlfYUlrTWy3O0wAAAAASUVORK5CYII=","aspectRatio":9.523809523809524,"src":"/tetrahex-rawsas/static/c8467caf385b1ea421ad6fae5a7291b7/19ca5/frontmatter17.png","srcSet":"/tetrahex-rawsas/static/c8467caf385b1ea421ad6fae5a7291b7/69585/frontmatter17.png 200w,\n/tetrahex-rawsas/static/c8467caf385b1ea421ad6fae5a7291b7/497c6/frontmatter17.png 400w,\n/tetrahex-rawsas/static/c8467caf385b1ea421ad6fae5a7291b7/19ca5/frontmatter17.png 480w","sizes":"(max-width: 480px) 100vw, 480px"}}},"tags":["SQL"],"date":"Nov 18, 2016"}}},{"post":{"html":"<p>When we think about using SAS with Excel, one begins to groan at the myriad of options - DDE, SAS Addin, various Excel-ish library engines, IOM in VBA, etc etc etc.</p>\n<p>What if there were a simple technique, quick to set up, and easy to adjust?</p>\n<p>A technique that works on ANY version of Excel, requires no install, works cross platform and encompasses full metadata security (at point of connection)?</p>\n<p>A technique that has been available to us for at least 15 years¹?</p>\n<p>For those of us who work with <a href=\"https://rawsas.blogspot.co.uk/2015/12/building-web-apps-with-sas.html\" target=\"_blank\" rel=\"noopener\">SAS Web Applications</a>, the idea of streaming data via a URL is not unusual.  It’s a great approach as it ensures we can get the latest version of data, using the latest version of the code, with the permission set granted to that user at that point in time.</p>\n<p>Extending this concept to Excel is as easy as 1,2,3:</p>\n<h3>1 - Set up the Stored Process</h3>\nThe code below should be registered as a stored process using SAS Management Console with STREAMing output:\n<blockquote style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">/* STP URL Parameters */</span>\n<span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">%global</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> type libds;\n</span><span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">/**</span>\n<span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">&#xA0;* assign metadata library from libref\n</span><span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">&#xA0;*/</span>\n<span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">%let</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> libref=</span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">%scan</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">(&amp;libds,1,.);\n</span><b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">data</span></b> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">_null_</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0; </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">length</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> lib_uri LibName $</span><b><span style=\"background: white; color: teal; font-family: &apos;courier new&apos;;\">200</span></b><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0; </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">if</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> metadata_getnobj(</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;omsobj:SASLibrary?@Libref=&apos;&amp;libref&apos;&quot;</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">,</span><b><span style=\"background: white; color: teal; font-family: &apos;courier new&apos;;\">1</span></b><span style=\"background: white; font-family: &apos;courier new&apos;;\">,lib_uri) </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">then</span> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">do</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;&#xA0;&#xA0; rc=metadata_getattr(lib_uri,</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;Name&quot;</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">,LibName);\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;&#xA0;&#xA0; </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">call</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> symputx(</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&apos;libname&apos;</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">,libname);\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0; </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">end</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">run</span></b><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">libname</span><span style=\"background: white; font-family: &apos;courier new&apos;;\"> &amp;libref </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">meta</span> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">library</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">=</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;&amp;libname&quot;</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;</span><span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">/* set content type if CSV */</span>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">data</span></b> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">_null_</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0; </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">if</span> <span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;%upcase(&amp;type)&quot;</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">=</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;CSV&quot;</span> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">then</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;&#xA0;&#xA0; rc=stpsrv_header(</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;Content-type&quot;</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ,</span><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&quot;Content-Type: text/csv; encoding=utf-8&quot;</span></div>\n<div style=\"line-height: normal; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; color: purple; font-family: &apos;courier new&apos;;\">&#xA0;&#xA0;&#xA0; </span><span style=\"background: white; font-family: &apos;courier new&apos;;\">);</span></div>\n<div><b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">run</span></b><span style=\"background: white; font-family: &apos;courier new&apos;;\">;</span></div>\n<span style=\"background: white; font-family: &apos;courier new&apos;;\">&#xA0;</span><span style=\"background: white; color: green; font-family: &apos;courier new&apos;;\">/* send data */</span>\n<b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">PROC</span></b> <b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">EXPORT</span></b> <span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">DATA</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">=&amp;libds </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">OUTFILE</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">=_webout </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">DBMS</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">=&amp;type </span><span style=\"background: white; color: blue; font-family: &apos;courier new&apos;;\">REPLACE</span><span style=\"background: white; font-family: &apos;courier new&apos;;\">;\n</span><b><span style=\"background: white; color: navy; font-family: &apos;courier new&apos;;\">run</span></b><span style=\"background: white; font-family: &apos;courier new&apos;;\">;</span></blockquote>\n&#xA0;\n<h3>2 - Set up the Workbook</h3>\nThe &apos;trick&apos; here is simply to set up a web query to call the STP above. &#xA0;The options vary as per the version of Excel, here is the path for Excel 2010:\n<div style=\"clear: both; text-align: center;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.97872340425532%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACmUlEQVQozzWSSYvcVhSF9R8N+QMB7wxZZpHf4F0gy4DxwrsGBxLSMQ64vWiMxxpa1VJJpVl6mseaVPXlSsQPLucN9557dK60f7/43C8r9LhnGez56HTcOwfuA3i3G7lz4c6B9+50vsj+Mt+/NQ/8o3e82fTcPjQSLbd6i/bji6c8e/UzXnHCcBVRdcSOazZeQdxe0d0cI6jmc9RcsFXP2kkxo5qiO+JFKao+YIQVSytGu7n7iZt3v9CEb+n6I2XT03R7+n6ganuyomTn+qg0o6xqyrKiqhvKusMOB+pmoGlq/CAky3I0vJe0i+eM1nOmlUQmjVrM+5W/xYgcAi+kKApUkkhxQ9d25FnJp2+uNOykiaiPYippqFm3P2D8/YRq85t02/Ow+oZrP9IPezaPG3w/oKlrWlFRC57HkVpUlsVEEjJIXlnk0qjFdSw0f/krgf47hf8G1w0wTXOWX9UVSqXyGVIYJ4RRQqwyalGX5ZUoq8SiQWxoZjumN3u3RSt2BnlzRWUtaVYL0X7+3NMZtruAB8Pm80Lnw6cFYaykOJ8jlUYTBmGCI5ZYO49ABqTlxj1F/JU0+EwefmUcLDjsOLYW640phC6rjc2XpU6SCol4pwQTlc+o/r+bFKeCmmO/pvJeE29vKP0/GMtbTvmfDOovLMvAFJWTgq0o2Ji2oM+joG7ucPwYywnmN1tyHD9CS2XUZVmTiE9dv2e8IGYrPHkMw2ieXiT+JYmaBzQMB87nka7rOZ1OfF+Xy4Xr9SqEkS3JKb7nSwRSFGI8OiyXBquVyXq95WFtoes2i4WBYXgyqI4gyOcJj5eRUSY/kU+oTUZ/vzgeJQ5HaZDjOKGQJ3N4XiwEolDQlfskmf7JYs6flE1xPp9nnv8ABMx1rrNxbjQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1 300x174\" title=\"Capture 1 300x174\" src=\"/tetrahex-rawsas/static/3d475aea3c366957b6dd95b15cfc3a1f/5a46d/Capture-1-300x174.png\" srcset=\"/tetrahex-rawsas/static/3d475aea3c366957b6dd95b15cfc3a1f/4dcb9/Capture-1-300x174.png 188w,\n/tetrahex-rawsas/static/3d475aea3c366957b6dd95b15cfc3a1f/5a46d/Capture-1-300x174.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></div>\n<div style=\"clear: both; text-align: center;\"></div>\nNext step is to add the (appropriately formatted) URL, eg below. &#xA0;Note that I called my STP &quot;SAAS&quot; and placed it in a metadata root folder called Web.\n<blockquote><span style=\"font-family: &apos;courier new&apos; , &apos;courier&apos; , monospace;\">http://YOURSASMID:8080/SASStoredProcess/do?_PROGRAM=/Web/SAAS&amp;libds=sashelp.class&amp;type=tab</span></blockquote>\nWe are asking for the sashelp.class dataset, and for it to be TAB delimited. &#xA0;This gets pasted into the web query box, and gives results as follows:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 244px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 85.63829787234043%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAAC5UlEQVQ4yy2TaZOjOAyG+f+/aav2w9bsdk9nmtvgA2wD5gg3pDvcjMisikqhgJD0vK+1eV4g4Pc4zjRVjuOs6waxLOsV21aWpUpzP5CBSJlQgcxwEP319z+xKjQbMcslHhG65SHC4YFh+58WQpgbNnY8hqmEf0yHOH4Al2lj3fI9Kl0can4QwVXUg40ICWOpSsLEp+XJtPIZD6JUFTU8gps4K9W9YTxmUiV5HchUMxzs+MRFLsYkFPG6LBhjSlleFLdfepLELvIchAzjU0axC+8hTzc+kY/nZb2KQ5kQ7PEwjJL0PI8okmHI27b7+PmuUpXnuXeFW7WtUsr3PcPQE6X249BuhstCYZm6rpuW7a7LhBCquuE8z6HvTMs6gOR5qlgapg03MWee79MgfD4nzUJUyCSKRJblwzBu65oX+XJhXr+/HipNgfxjHISUVVWBLpCOQw+jTdOsmQ4OuMQEuZ4/fj3PY6ubZj/Ofd+hMwvC1wgtSJjnxbbtkI5DB+lVDGO7HvYh0EUjUyov7i+lN6ghlMHb5b0AZmmWwUSQPsbeMMxpnjVQhTIOqANGKaFVeW/adt32/8fjAnbu24ayoHh9dJ6mDlLKrs4fuhPyiGBi6kbTA6ctg/H2A8Zum8qyL0hlkd9uN8oYoGMU/7p9wLee06SBewIexVGkElU33bGtSZL04wMafj1GLq7OXdvKSFZ1ve17XVdKJUD3tbPp0lBQggOKoyQ79i0Mg254XJy6lrFr566pQZ6iKKBzJIWH3DhOgLymO74QEtOAEBxyuW8LJrhqOqjpuwaAQee2qX1MwBhwWi7afWOa1nNaNNMlQkahEGAs4AzFcRJ/PyfYeey7kHMoHoZOyqi4pAIfrAAV1oHTqP1410Fxw7bBtyDjvs7g6hewrWtrx/WgVVtXb2/vhNLj0ml4++9fH+Mn7AznLlZplueci7brwST3svwj1fMbHJZdUnU9uPqPhF0D4BpoMM/zb6+PmGlTqzsRAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 2\" title=\"Capture 2\" src=\"/tetrahex-rawsas/static/772d8a8b8ba580a6e3a655ae3b3721d5/0cba8/Capture-2.png\" srcset=\"/tetrahex-rawsas/static/772d8a8b8ba580a6e3a655ae3b3721d5/4dcb9/Capture-2.png 188w,\n/tetrahex-rawsas/static/772d8a8b8ba580a6e3a655ae3b3721d5/0cba8/Capture-2.png 244w\" sizes=\"(max-width: 244px) 100vw, 244px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nWe now have our data in excel, but for those who wish to avoid the need to &apos;right click / refresh&apos; we should:\n<h3>3 - Automate</h3>\nThe beauty of this approach is that it is so easy to automate in VBA!\n<div style=\"clear: both; text-align: center;\">&#xA0;<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.808510638297875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABa0lEQVQoz5WSW3PiMAyF+f+/bulDS4gT29lcjHNnccCE5VuFzvS1XY2PNZKlM/IZ7dr2Qvm7wRpNnucY8d57eD7l/D929/vK4VCgdY61DYV1KFVz/hPZ7MnP7IvwsT7Ia4NuDU3n0N5QtDV5ZTBOU/iCZnCSM2RNRtmVuOGElbzb8t4SlvBFKoQrbesZp4k0TUmSRKbVpMeEj/d3mT4hl1iplIO8bTXG2le8SaSUwmhD2/Uv0t16f3BygbKQqVRG8iEESmMyKU4zdKY5Ho7UZUO8RlaRiL/wEL/1bvEaV56PT3F223WLV4pTgRX4wdOHQb7ToJ2hv7RUbYWfPed4Zr5NdKFjuI6MgunlJ+npGZdRCIX4vkaaqUb3mmqsUE5RTxX13JCdLOUkWzBZqrkWlJjB4M6O5X4lxCBYuMSLxMvnhEsIvO337H+9UVWlSHCiF01ut0jXBubpyk9tt4RIUYzU1cQ4hm/X4jv8AxYXrfFR9bQiAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 3 300x141\" title=\"Capture 3 300x141\" src=\"/tetrahex-rawsas/static/3dcc27ecd8618e56b5ffdc72184a19d6/5a46d/Capture-3-300x141.png\" srcset=\"/tetrahex-rawsas/static/3dcc27ecd8618e56b5ffdc72184a19d6/4dcb9/Capture-3-300x141.png 188w,\n/tetrahex-rawsas/static/3dcc27ecd8618e56b5ffdc72184a19d6/5a46d/Capture-3-300x141.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></div>\n<h3>By the Power of Greyskull</h3>\nNow that our STP is configured, it is gobsmackingly straightforward to get the power of SAS into Power BI. &#xA0;Again, simply select Get Data and Web:\n<div style=\"clear: both; text-align: center;\"></div>\n<div><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 269px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 111.70212765957446%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAADNElEQVQ4y51V227TQBD198Mf8ASPFKlACm2FQAUkGkKcOInTXH2P4zip706cW9vDzBYjhIC2RBqtvd45O3PmzETy/RmciQt/HiAIQswvQ6RJgok3x8XYEXuXZGNzQmcWSOKYzkQIwkg8s99M+EaYLwJI7tTDKicnR8EiTOFcbuhwjL7m4FNTB3/3ZjOcVnuoqTrSOIQfb2D7KcIwgOGGUI0I/iJEXbUgNZU2lG+foX45gOlModk+THuKiWNhOrHgOA5m3hRyu4+xTnvuBBpF2+nplNmEfGYYGp64mPekt2+O8OjRYzx/cYiW0kRDrmM0GqEpyzg+PoWm6+j3enj/7h263S4Meu+qKnoXF7BtG2qnjUZDhmmaUJoyJLlex9HRET5++ohms4k6vfd6feiaBpUcbcuCTOCq2sVwOMSEonJdVxhHz5cPhyPxzBdL0ymlZzuwdBMWOff7BGaYWC6XKIoCURSh1WqJb5ZlwjAM6BRlaRxZaaPhAFKWZkSwi7FnYb/bIQpDbLdb7Pd7YQwa0t5msxHP6/X670ZnpOvtHhX5A56cHWBTrIl0F3m+FOAMuFqtkGUZ7vuTOLUkS7Estri+vhabvF5dXQljwDRNf+7f3Nz806Qsy7HMYuS+iixNBC9cPYd43W53Is0S8C4wAcjpLfMYK7+BHXHHXDBfbBzRfwDmSDnK4koUg1MsVsXt+gPsQYAMViwTFMGAipFBI/1ZpgXP88TKunsQIBclz1Os87koQkl+WSCm4EGALImUtBgnmRCz581E6juSDduvVb43hww6n8+Fc5KkAog1yBE/uCjceha1jU1txf1Y9igb88cyWiwW99dhp92msWTirKrg5eEhnj59hlevX+Pk5ERYpVIRl5QR3tkpmjZGo9XB57qK2tevYtrwdKnVaqhWqzg/PwdnwbpkjpmW341p4ZXPCA7jOCJx52KDBwFzFtOU4VnHg5MDK4fFn4z9WA1BQH8BWb5CHnjIlApFkIv557o8sYlP5pB0yZPZ0LXblvzBLWuURxq/c7dxYZlrocP1iiycittK4jckHRa5oijodNTbKU0DlG0wGIhV7XTEEGZQnoeslO/b5XYk3ybC6gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 4 269x300\" title=\"Capture 4 269x300\" src=\"/tetrahex-rawsas/static/6da457b9ed9d9f705ce860fdbbf09cc3/98fe2/Capture-4-269x300.png\" srcset=\"/tetrahex-rawsas/static/6da457b9ed9d9f705ce860fdbbf09cc3/4dcb9/Capture-4-269x300.png 188w,\n/tetrahex-rawsas/static/6da457b9ed9d9f705ce860fdbbf09cc3/98fe2/Capture-4-269x300.png 269w\" sizes=\"(max-width: 269px) 100vw, 269px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></div>\nEnter an appropriately formatted URL, using type=CSV in the parameters:\n<blockquote><span style=\"font-family: &apos;courier new&apos; , &apos;courier&apos; , monospace;\">http://YOURSASMID:8080/SASStoredProcess/do?_PROGRAM=/Web/SAAS&amp;libds=sashelp.class&amp;type=CSV</span></blockquote>\nYou may then need to select the appropriate credentials with which to connect (eg windows authentication for IWA, or use Basic if you normally enter passwords for SAS).\n<p>In the final screen simply mark the type of your input:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.95744680851064%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACSUlEQVQ4y5WS3U+SYRjG33+I4eAgF8i3gwLEaqWZdsBqAwYDOcETvk6MGa0Nxpp/AHOceMBJRzkZgS2NmU1qkEgJGAkhX+qw7ep5noJqeiDvdm3P/b57f/d13ffD6Qy3IRJdh1Qqg1gsxtjYGEZHr0EgEEAoFDLRs0gkwvz8PBwOB5xOJxYWFuByuS6Iu6GbhF6vx9T0NCYNBhgMtyCXScDj8TAyMgI+n8+AtJHNZkM0GsWzYBBWq3XQgMput7NG3MzsA4yPq5i7vkOJREIcSweitUqlgtliRjabxeuNFBafLCISiSAcDiMUCrFzIBAA9zzowvLyC9LBwTpSFyaTCWazmYmeLRYLjEYj+/Z0aQkrb16i0qqh+aOBxvEx+k8qlQL36LERWu1NFptKp9ORWjtQv56YmGCxPF4v0rEVNCsVNJpNHFYO0el2GXB9fR3cnalZElMMhUIBuVx+QfS9TCaDWq1mQJ/fj+LWO/TabbQ6bdTrdZycnP4F3puZI0uQkRmNszldJqVSCY1G8xvo8yG/X8Dp2RlqR0fodLqDyIlEAtzd+3PEgXTw42WiLimQbtPtdmNrcxPvt7extvaKzC2NTCaD3d1dxGKxP0Dp1YEejwcfP+VwUCohSyC5XA7F/SKq1Sri8TiN/PDKQBrZTyK/zR6g2wOajTrK5QrOz3+yyMlkcligA16y5c97e+iSzX6vfkOpVEav1/t3KcM59Pm8KH75ygD1GrmLzdb/93AYYH+GqfQG8vk8W87OzgcUCgVUyL1cXV3FL/x/eOZJ4/i8AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 5 300x198\" title=\"Capture 5 300x198\" src=\"/tetrahex-rawsas/static/99eb05ea6ab86ca833957dafca7ed1f0/5a46d/Capture-5-300x198.png\" srcset=\"/tetrahex-rawsas/static/99eb05ea6ab86ca833957dafca7ed1f0/4dcb9/Capture-5-300x198.png 188w,\n/tetrahex-rawsas/static/99eb05ea6ab86ca833957dafca7ed1f0/5a46d/Capture-5-300x198.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nand - voila!\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 34.57446808510639%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABXklEQVQoz3WQzWrCUBCF8y7diLpsKRgfo0IF60tYIlS6decP7vsGXXVbKF3oTUwsWEvF4F/UqImaH8H96Z1bG6S0i8PMYS7fPTPS+WUKD9Us2o8X+Hg6Q/v5HsWigrScRvb6GpVqFfl8HrIso1wuo1C4ReYqw30KpVIJd1y5m5zwiqJAisfjqNcqYK1XqK0XGDqDNZthvV5jtVrBdV0h6ieTCRzHEVoubQyHQ/HOcckv8d7tHoH1OlS1DcY06IaBzWaD/X6PMAzh+z6CIBCeoORD3lO1rFk0PxwOGI1GkBKJBE9YQ7PZ5MAWdF3nCVzx0PO8SOQXiwV2u53ot9stxuNx5H3fQ7//CSmZTKLGgZqm8ZSqANq2LX49hZHm8/k/wED4Xq/3DaSVGWNCBKQkv4HBSUKaUZ1Op9GczmMOBpBisRgajQY6nTcBNI43/Csh3fDHexxoWdbJyj5M08QX4mzRSny4IeMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 6 300x104\" title=\"Capture 6 300x104\" src=\"/tetrahex-rawsas/static/613dddda6eb4318598b4430fbd4f4351/5a46d/Capture-6-300x104.png\" srcset=\"/tetrahex-rawsas/static/613dddda6eb4318598b4430fbd4f4351/4dcb9/Capture-6-300x104.png 188w,\n/tetrahex-rawsas/static/613dddda6eb4318598b4430fbd4f4351/5a46d/Capture-6-300x104.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\n&#xA0;\n<div style=\"clear: both; text-align: center;\"></div>\nOf course this is a very simple example, but using the above template you can start to add more parameters on the SAS side - enabling where clauses, drop statements, business logic etc.\n<p>The same approach can be used to get data into Powershell, Python, R, uncountable client applications, and of course - javascript (see <a href=\"http://rawsas.blogspot.co.uk/2015/12/building-web-apps-with-sas.html\" target=\"_blank\" rel=\"noopener\">building web apps with SAS</a>).</p>\n<p>Got any other tips?  Please share in the comments below..</p>\n<p><b>References:</b>\n<span style=\"font-size: x-small;\">¹ Vincent DelGobbo discusses web queries with SAS/IntrNet in this SUGI27 (2002) <a href=\"http://www2.sas.com/proceedings/sugi27/p174-27.pdf\" target=\"_blank\" rel=\"noopener\">paper</a> </span>\n<span style=\"font-size: xx-small;\">2</span><span style=\"font-size: x-small;\"> Stig Eide also discusses this approach in this <a href=\"http://bi-notes.com/2013/02/sas-stored-processes-querying-a-stored-process-from-excel-without-the-add-in/\" target=\"_blank\" rel=\"noopener\">blog post </a>from 2013</span></p>","frontmatter":{"title":"SAS As A Service - an easy way to get SAS into Excel, Power BI ","path":"/sas-as-a-service-an-easy-way-to-get-sas-into-excel-power-bi-and-000s-of-other-tools-languages/","previewImg":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACTElEQVQozyVRy27UMBTNT7Jg3w+AHULiC9gAEizZlA1iRQXqglIqNANVK9GWmU4zedqOYzsPx3HsPCeZ4NKro6Mj21f3HF/rN7hbrMjlbemkzYZ0V6i+QN0lmZdoWkaG97/QvICTEQswnvndybY+3dYndnViK+vZ0cuDw4Onn55DXntRxmQfJsqJS1pNDhYuKd1YUjmBrLFRHqaa6x6zPJG9S6T19fzt5+WTo+WLiv7Q9SBVq3TXNI2q20JIgHCW5WUpxQNkjdO20q1SFaHMEsHHHh3K1asRvN7Pc8ICmazmed5g36WIUVYUeZKkSqlGNzkXF9eQi5pzThmzgtUHdPbY//ZIbt8pPTj2GkOva3vP93BMykJorbTW036vZCUKwQjp+r7gXNe1BYKf6OYNcd4rdoox8VwP47iUMkmM34KxNCaMJVlVqYyXZrJS2sQxt5RmlutsSuQKNXNhQlaibIzncRy9MHJ8dHPrXK9tluYZFwZ5URqmLItihiJi+f6WexcF+cPgZRZfjU2wb4OdDja2Z3vR2g6u19s0F1xIM9mAF5IXhsuirKzN3SKGxwX8QrwjgY/38nSU33fiFAAQIoZZFsLYDRCIqOsjYwdiFkDihRhEzHL8qyzjUiqTUOlm2E0oogHAEEAAYGAUjn0/NA/6fldVehiG/f8ap9FauSCjoShKsw9TZjcQUM+LfC9yXRQC6vvYCAhZIVrGRNd15uenaRqnyTr/G+A4GYZd1/WtQdslCY8QjXESx+kDME7MSZYKg2G3u2++nzz9A6KUhIROjkBiAAAAAElFTkSuQmCC","aspectRatio":1.7241379310344827,"src":"/tetrahex-rawsas/static/c4a2ea2573c821168d81194e9a63d3df/5caba/frontmatter18.png","srcSet":"/tetrahex-rawsas/static/c4a2ea2573c821168d81194e9a63d3df/69585/frontmatter18.png 200w,\n/tetrahex-rawsas/static/c4a2ea2573c821168d81194e9a63d3df/497c6/frontmatter18.png 400w,\n/tetrahex-rawsas/static/c4a2ea2573c821168d81194e9a63d3df/5caba/frontmatter18.png 439w","sizes":"(max-width: 439px) 100vw, 439px"}}},"tags":["SQL"],"date":"Nov 18, 2016"}}},{"post":{"html":"<p>It is perfectly valid to use <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">min()</span> as a <a href=\"http://support.sas.com/kb/25/279.html\" target=\"_blank\">summary function</a> on character values in <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">proc sql</span>, eg as follows:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> min(name) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br /><br />This is not so, however, when using in an inline context:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"><br /> </span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> min(name,sex) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br />Which gives:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; color: red; font-family: &quot;courier new&quot;;\">ERROR: Function MIN requires a numeric expression as argument 1.</span></div><div><span style=\"background: white; color: red; font-family: &quot;courier new&quot;;\">ERROR: Function MIN requires a numeric expression as argument 2.</span></div></blockquote><div></div><br />So what are the alternatives?  If we were in datastep, we might have had the option of the little-known<a href=\"http://support.sas.com/documentation/cdl/en/lrcon/62955/HTML/default/viewer.htm#a000780367.htm\" target=\"_blank\"> infix operator</a> for min (>&#x3C;):<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  minval=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Less’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">>&#x3C;</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘More’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">>&#x3C;</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Lots’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval=;  </span><span style=\"background: white; color: green; font-family: &quot;courier new&quot;;\">/_ minval=Less <em>/</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span></div><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div></blockquote><br />As it happens though, the min &#x26; max infix operators are not valid in proc sql.  Another approach, if comparing just two values, would be <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">ifc()</span> - eg:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span>  <span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> ifc(name&#x3C;sex,name,sex) </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minval<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><br /><br />But what if we have more than two values?  In this instance, it becomes necessary to take matters into your own hands!  I’ve gone ahead and rolled up an FCMP function below, which could surely be improved, but does the job when comparing three character values in either data step or proc sql:<br /><blockquote style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"><br /><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">fcmp</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">outlib</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=work.myfuncs.test;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">function</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minC(a $, b $, c $) $;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">length</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> result $</span><b><span style=\"background: white; color: teal; font-family: &quot;courier new&quot;;\">1000</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    result=a>&#x3C;b>&#x3C;c;</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">    <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">    return</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> (result);<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">endsub</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">quit</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">cmplib</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=work.myfuncs;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"></em>null_</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">x</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Killing’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  y=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Me’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  z=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘Softly’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  outvar=minC(x,y,z);</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"><br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> outvar=;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">proc</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">sql</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">create</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">table</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> test </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">as</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  <br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">  select</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> minC(</span><span style=\"background-color: white; color: purple; font-family: &quot;courier new&quot;;\">‘Constant’,</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">name,sex)</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\"></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">  </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">from</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> sashelp.class;</span></blockquote><div style=\"line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;\"></div><br /><div><br /></div>Would you deal with the requirement any differently?  Let me know in the comments!<br /><br /></p>","frontmatter":{"title":"Finding MIN (or even MAX) of character variables in SQL","path":"/finding-min-or-even-max-of-character-variables-in-sql/","previewImg":null,"tags":["SQL"],"date":"Nov 08, 2016"}}},{"post":{"html":"<p>Noticed today that our UAT 9.3 environment was failing to execute the SAS <span style=\"font-family: Courier New, Courier, monospace;\">ExportPackage</span> <a href=\"http://support.sas.com/documentation/cdl/en/bisag/64088/HTML/default/viewer.htm#a003261084.htm\" target=\"_blank\" rel=\"noopener\">utility</a>, with the following error returned:</p>\n<blockquote><span style=\"font-family: Courier New, Courier, monospace;\">The export process has failed.  The native implementation module for the security package could not be found in the path.</span></blockquote>\nI'd come across this issue <a href=\"http://stackoverflow.com/questions/29901224/using-iwa-with-sas-exportpackage-utility\" target=\"_blank\" rel=\"noopener\">before</a>, and this was (effectively) the same piece of code.  So what gives?  I launched a shell session locally, using the system account (sassrvuat), and reran the command.\n<p><i>It worked.</i></p>\n<p>Hmm..  Must be an issue with the UAT machine (most likely since our 9.3 upgrade as it worked on 9.2).  I logged into sasapp with sassrvuat and tried to open DI Studio using IWA.  I get an interesting popup:</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 53.191489361702125%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACYElEQVQoz02STY/TVhSG/S9ZdNENVET9E+zLj+gMoCIkKNBWzAYoM0kmtidxvuPPOP5O4sRxEkCCzcOxMxqxeHTu0X3v63vea+V+K+L35oKHVz6NW+7WrYDf3pv8+lrj4SePhugaP+kal3MeqBmPnvzDn7/c4+XbC5QzK+eFu+GZteKZWbGs69PZkqeyPhtFnPV9zieJkNY8mWZ3nIvmr67Ni/91nuszFOPxH8RvXpHFIRNdwx70BIOx1sEyukxvbvAmQ5xhn8iySFyb1LOJbJPYsQnMCe54QLbdcWFGKOOPn0hGI6Jsycy0cTwPx/WYziw8P8D2fEbjCXGasT8e2e5KioryRNWXUhMx/Hfio2y/fefz1y/s93uOcuDz8cA829LzUpoDi1GQ4wQJmtrh8vKSwWBIFEW1SVEUYr5jvyvIipL/pguUaLlilaWs12s2mw07EWXrDWG2JkxXRMucRG6fJElNmqbkeX4yFLPKtBTDON/KyCHKSMbUVJUr+bon4yZJTBgExGFIHEckUUh6a1YRxzGB7Pv+otaFcts4DFiWB56rQ5TucExPgu90VIyegdHtYRh92q02V80W1+02mqbRvGoykqwrM8dxBJeFmC6kD3yf5W7P330bRTUGYtjlpjbqyW11ut0u19dqnZeu6+iaTkfVGI7GtZErk9jywjPTxHXn+PO5PEp5emVbBM50zHQov8ZsijWZMB30mcnhg2RzKLYcyx1fDmXdF5J1ka9qNsuMneR52OYUhyPvqgw/WiEdN6Rd4YRc39aKlh3c1dM6uNs7aaO6doQPZsBrGfkHFVEDFdgzV7kAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 300x159\" title=\"Capture 300x159\" src=\"/tetrahex-rawsas/static/885ea517d55083a228903b2d8732c7df/5a46d/Capture-300x159.png\" srcset=\"/tetrahex-rawsas/static/885ea517d55083a228903b2d8732c7df/4dcb9/Capture-300x159.png 188w,\n/tetrahex-rawsas/static/885ea517d55083a228903b2d8732c7df/5a46d/Capture-300x159.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<div style=\"clear: both; text-align: center;\"></div>\nSeems my old colleague <a href=\"https://no.linkedin.com/in/stig-eide-6364622\" target=\"_blank\" rel=\"noopener\">Stig</a> was onto something with regard to the&#xA0;<b>sspiauth.dll</b> file and 32 vs 64 bit compatibility. &#xA0;Checking out the folder below, we can see several versions:\n<div style=\"clear: both; text-align: center;\"></div>\n<div><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.872340425531917%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABHUlEQVQY002NX1eCQBTE+f7fqHroHE2z0koROokKLOwuywJK/M2U6bq99DBndub+7l1LJQnSNEUYhvB9H0opJNRdsxDCzILAR6Y1pJSmZ4yZrP+Jc46qqmApnaM4lOi6Dk3ToKrrP6dhTd51LVJiuFSIhcIX9XleIMsPZqdtWxzL0jB938NiqsTregd7EyGtBmQNoMl1PRi/ZpZW+AwSeEwjpkIUvcl7XmAbZUiOJ+Iv8KIclhsWuJl5uH3aYrSSeGffWIsLbH42cuSAxa7Ew1pg6iaY0/staDBexXj8SDFxEixZT9wZY0fRwSDD3bOH+8UeoyXDKmzhih84/GTkErjYHjCxY0wdScePxDSYuRJzL8fLRsOOOto50acSv3w+cKLDE9zzAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1 300x69\" title=\"Capture 1 300x69\" src=\"/tetrahex-rawsas/static/cb8d91f833e53f06f4f58ea911131fae/5a46d/Capture-1-300x69.png\" srcset=\"/tetrahex-rawsas/static/cb8d91f833e53f06f4f58ea911131fae/4dcb9/Capture-1-300x69.png 188w,\n/tetrahex-rawsas/static/cb8d91f833e53f06f4f58ea911131fae/5a46d/Capture-1-300x69.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></div>\nComparing the file sizes it was clear that we had 32 bit DLLs (112kb) instead of 64 (107kb). &#xA0;The solution therefore was simply to copy sspiauth.dll from:\n<blockquote>\n<ul>\n \t<li>C:Program FilesSASHomeSASFoundation9.3coresasext</li>\n</ul>\n</blockquote>\nTo the following locations:\n<blockquote>\n<ul>\n \t<li>C:Program FilesSASHomeSASDataIntegrationStudio4.3</li>\n \t<li>C:Program FilesSASHomeSASPlatformObjectFramework9.3</li>\n</ul>\n</blockquote>\n&#xA0;\n<p> </p>","frontmatter":{"title":"The native implementation module for the security package could not be found in the path.","path":"/the-native-implementation-module-for-the-security-package-could-not-be-found-in-the-path/","previewImg":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAACGElEQVQozyVOy3LTMBT1R7Jiw6YMLV/BD8A3UEI7nSm0dGDDhunUTmrLjh05fsQPOX5K8lNWHMoMwwKlOTpzde7VnKMrnSyqt4vsVE5PlezIM8F58fpX8OrOePOQnM3F8PiansnbE42+m/2YvXxxefdTOg/a67i7DJqLA+uD2NCLTT1zyk92OvPwzCOCn336TDIL6iszurkHH4EvwQ/vq+/faFV4uo7WMLSha4BwZXrL5dZ3RVuGAUERTuIyCqs4LEIf+U4zsFsvl9z7B+I4Ja03fogQihO0CaIkzcMo8TyvrAifpoGNbBwZ5wMfh5GPnNds/GInEvv7b//0tOO7ab//vZ8SMlgIz+3ALfo4x9rjoywr0IZFUXBhFmAiibUj/7reSmXdNJQ2bdv1PWMDbbuCtgVpirrDlFZVhTEmhLRtO4rPn8EZo/1w62aSG0Q6AIosJ8mWYFzkOa5KgqtnEkqo8IqIsiyyNCvFVZSi6fjuXHMk03aspQkAWFkQWitrBRfzhaLMVVUFh1BlvV7neR7HkThCpGmWZ5kwX5mhBFbQNEzDMFeWBYBuWtbjQoPQNoylgKrqrufFCEUxCqMoCAKEErFjzfhh7UOk7/g2RL4XuY5nw9BxpqGbhn7Phj87LsTY1mPbsLbuazJ2zdR30366EWZlS4281vMaZPRYQUrVLdZSom2xmhyEmIBjzaiWUj0lMsLXMP4PcQcqhfGk9jUAAAAASUVORK5CYII=","aspectRatio":1.8867924528301887,"src":"/tetrahex-rawsas/static/6833f88a6bf3c95adf412b4eaa32aff5/9b5ec/frontmatter19.png","srcSet":"/tetrahex-rawsas/static/6833f88a6bf3c95adf412b4eaa32aff5/69585/frontmatter19.png 200w,\n/tetrahex-rawsas/static/6833f88a6bf3c95adf412b4eaa32aff5/497c6/frontmatter19.png 400w,\n/tetrahex-rawsas/static/6833f88a6bf3c95adf412b4eaa32aff5/9b5ec/frontmatter19.png 430w","sizes":"(max-width: 430px) 100vw, 430px"}}},"tags":["SQL"],"date":"Oct 05, 2016"}}},{"post":{"html":"<p>Having been blessed with an en-dash (alt + 2013) in our TFS project root, I’ve been having lots of fun getting SAS to ‘play nicely’ with non-ascii characters when running OS commands (eg tf.exe).<br /><br />Storing the values in macro variables works fine for direct use (eg in an X command), but running a SAS generated .bat file was proving challenging - until I realised that the issue was actually within the windows shell, rather than SAS itself.<br /><br />The solution turned out to be twofold.  Firstly, the batch file itself needed to be UTF-8 encoded WITHOUT the BOM marker.  This required the <span style=\"background-color: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span>  system <a href=\"http://support.sas.com/documentation/cdl/en/nlsref/61893/HTML/default/viewer.htm#a003105792.htm\" target=\"_blank\">option</a> to be in place before creating the file.<br /><br />Secondly, the shell needs to be configured to read UTF-8 characters.  This can be done by changing the codepage (using  <span style=\"background-color: #eff0f1; color: #242729; font-family: &quot;consolas&quot; , &quot;menlo&quot; , &quot;monaco&quot; , &quot;lucida console&quot; , &quot;liberation mono&quot; , &quot;dejavu sans mono&quot; , &quot;bitstream vera sans mono&quot; , &quot;courier new&quot; , monospace , sans-serif; font-size: 13px; white-space: inherit;\">chcp 65001</span>) and <a href=\"http://rawsas.blogspot.co.uk/2016/08/chaining-windows-commands-in-sas.html\" target=\"_blank\">chaining</a> with an ampersand.<br /><br />Sample code as follows:<br /><blockquote style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">options</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">nobomfile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> work=</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%sysfunc</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">(pathname(work));<br /></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">%let</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> file=&#x26;work/mybatchfile.bat;</span></blockquote>         <b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">file</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">”&#x26;file”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">encoding</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">=</span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘utf-8’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“dir \"\"&#x26;work\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; font-family: &quot;courier new&quot;;\">      </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">put</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">‘echo Nonstandard – Dash’</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">run</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">    filename</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: purple; font-family: &quot;courier new&quot;;\">“chcp 65001 &#x26; \"\"&#x26;file\"\" ”</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; font-family: &quot;courier new&quot;;\">    </span><span style=\"background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; color: navy; font-family: &quot;courier new&quot;; font-weight: bold;\">data</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> mypipe;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span><br /><br /><div></div><br /></p>","frontmatter":{"title":"Reading UTF-8 in Filename Pipe","path":"/reading-utf-8-in-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Sep 06, 2016"}}},{"post":{"html":"<p>There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href=\"http://blogs.sas.com/content/sasdummy/tag/powershell/\" target=\"_blank\">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just <b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I’m going to split the example over three lines:</div><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$uri</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">”<a href=\"http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do%22\">http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do”</a></span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">$pgm</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">=</span><span style=\"color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">“/Products/SAS Intelligence Platform/Samples/Sample: Hello World”</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"></span></div><div style=\"background: white; margin-bottom: 0.0001pt;\"><span style=\"color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;\">invoke-webrequest</span><span style=\"font-family: &quot;lucida console&quot;; font-size: 9.0pt;\"> <span style=\"color: navy;\">-Uri</span> <span style=\"color: darkred;\">”</span>$(<span style=\"color: orangered;\">$uri</span>)<span style=\"color: darkred;\">?_program=</span><span style=\"color: orangered;\">$pgm</span><span style=\"color: darkred;\">”</span> <span style=\"color: navy;\">-UseDefaultCredentials</span></span></div></blockquote>Which gives the response:<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"./images/Capture.PNG\" style=\"margin-left: 1em; margin-right: 1em;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.2127659574468%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACjUlEQVQoz2VSCVPaUBB+eCHUYpWptiJHQkAIpxAIl8ihooC0SMKRICJHAJEKyuHRmU7/eTfB0U47882bfcfuft+3D1mTd47UvfNs7M1M7ccj7LBviN76szMyOXQcj6jMJJCbUbkZFr2lzqdUduI8ufekxwAiNkBq95XadfV5v75IFBHGKKzcmo1HujzCCrBFhgLSX4jr/4DbeP4pXfrpTAy0vuaW9xoL9fxnI7mlvGQuL++9ofIWr1gqC6bSHGjdVdt012RGVkaUkJHdcNXz1V+OeH/X3yYiXS3d0tKChmruUE2tr6Whm8RBb9lcQkRRBkwRziKcgWgBNjijctTy1d/UyXDb29AHhF1fC+jA7aKptCh1E1cpU0yWvUbiEXRWWnk6/YCFBUSwC6bXQwmMxK74NxAW7hmCArASNRhZ9X6DPOxjQYGI3Nhit2u2qspe/WivrjsuV/bKoklSrXkhJLdyKxbRCYk2q3bXD3KT5MVj9Ns0lpu5j+4ShcdU8dkW639y1lSOy/dCRtA8ZwWaoTPGbFHNRP6JSg2DmTF9dh/7/njMPIfSY29q5DsdeU9HGrq17blWWjmxMwx2SRQmJeMM+BTMTOzJgT/7YAp3tIG2xtdcIzmEgQVFGXSDsQPAZpAQyE4dyQFEMskbjb/tPRmaIj3zYR+msgn/x3NtCHWwcFdHt4GwNiBgIeEr1cAjXWQ/+mGN3Xyw8SAb6sEdGR+obLzSzq+SnPgr9soKkocHcktlyVxSkJyS5FetFThBicJL+HysCwpyGL2+sOtvfaEa8L1AFShSQBWSgy0oEh2aTw5nX9d44eWIfQJvTJHutqeuC3RcybsdXxOP9gzhjiHS0QfbG64aPP1nyIA/fYm1iR5ij54AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 1\" title=\"Capture 1\" src=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png\" srcset=\"/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/4dcb9/Capture_1.png 188w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/5ff7e/Capture_1.png 375w,\n/tetrahex-rawsas/static/a95cb96dee57ea53e5896ef5eeafb00c/e17e5/Capture_1.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></a></div><br />The key part to this request, to avoid HTTP Status 401 and “This request requires HTTP authentication” response, is the <span style=\"background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;\">-UseDefaultCredentials </span>parameter.  This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output </li><li>You may need to set your execution policy (explained <a href=\"http://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/\" target=\"_blank\">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul><br /><blockquote><div style=\"background: white; margin-bottom: 0.0001pt;\"><br /></div></blockquote></p>","frontmatter":{"title":"Invoking Stored Processes with Powershell - the easy way","path":"/invoking-stored-processes-with-powershell-the-easy-way/","previewImg":null,"tags":["SQL"],"date":"Aug 31, 2016"}}},{"post":{"html":"<p>Using <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">filename pip</span>e (instead of the <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">X</span> command, or <span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">call execute</span>) is a great way to submit OS commands, not least because the standard output can be read directly into SAS.<br /><br />But how does one submit multiple commands in the same filename (or file) statement?<br /><br />Easy - &#x26; I’ll show you how:<br /><br /><div style=\"margin-bottom: 0.0001pt;\"><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  data</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\"> </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\"><em>null</em></span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">infile</span><span style=\"background: white; font-family: &quot;courier new&quot;;\"> <span style=\"color: purple;\">“D: &#x26; cd \"\"%sysfunc(pathname(work))\"\" &#x26; dir” </span></span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">pipe</span><span style=\"background-color: white; font-family: &quot;courier new&quot;;\">;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">input</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">; </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: &quot;courier new&quot;;\">    </span><span style=\"background: white; color: blue; font-family: &quot;courier new&quot;;\">list</span><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><div><b><span style=\"background: white; color: navy; font-family: &quot;courier new&quot;;\">  run</span></b><span style=\"background: white; font-family: &quot;courier new&quot;;\">;</span></div><br />The above snippet opens a shell (via the pipe fileref), changes the working directory to the D drive, then to the work folder (our work location is on a different drive), then executed the dir command to demonstrate that we are indeed in the work folder.<br /><br />The delimiter is, of course, the ampersand (&#x26;).</p>","frontmatter":{"title":"Chaining Windows Commands in SAS Filename Pipe (&)","path":"/chaining-windows-commands-in-sas-filename-pipe/","previewImg":null,"tags":["SQL"],"date":"Aug 09, 2016"}}},{"post":{"html":"<p>Currently working on putting our SAS deployment process into TFS and Release Management - part of which involves creating a ‘build’ in Visual Studio.<br /><br />The below caused a build failure, and didn’t come up in google:<br /><blockquote><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\"><br /></span><span style=\"font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;\">Exception Message: The build controller Visual Studio Controller - internal-svr-name does not contain an enabled build agent with name * and no tags. (type SoapException)SoapException Details: &#x3C;soap:Detail xmlns:soap=”<a href=\"http://www.w3.org/2003/05/soap-envelope\">http://www.w3.org/2003/05/soap-envelope</a>” /></span></blockquote><br />The fix was very straightforward (presuming you are using a Default Template).  In Visual Studio, simply open your build definition, in the ‘Process’ section, under ‘5.Advanced’ expand ‘Agent Settings’ and set your Tag comparison operator to ‘MatchAtLeast’ (instead of MatchExactly):<br /><br /><div style=\"clear: both; text-align: center;\"><a href=\"/tetrahex-rawsas/27bddd216c56524ef4829a50eab7038b/Capture_2.png\" style=\"margin-left: 1em; margin-right: 1em;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; margin-bottom: 1.0725rem;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.893617021276595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAfElEQVQI123G0QqCMBQA0P3/PwVBhPkk9lASiBXWam6Zd3dz04u3wNfBeThCq5dRchodBbdQZKaUBRG07hAtWgAY+o/xDsXNhPIOlfQnOZ7fse454ctXZVVnfCQXVvP/4tj6bTUUDyok5y0fUvIn7y6wKeW+DlkzZ820+gG15aaVjhA4NgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Capture 3\" title=\"Capture 3\" src=\"/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/6af66/Capture_3.png\" srcset=\"/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/4dcb9/Capture_3.png 188w,\n/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/5ff7e/Capture_3.png 375w,\n/tetrahex-rawsas/static/4203ef6493e897672e6bdef7f561f347/6af66/Capture_3.png 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></a></div><br /></p>","frontmatter":{"title":"Visual Studio Build Controller does not contain an enabled build agent with name * and no tags.","path":"/visual-studio-build-controller-does-not-contain-an-enabled-build-agent-with-name-and-no-tags/","previewImg":null,"tags":["SQL"],"date":"Jul 29, 2016"}}},{"post":{"html":"<p>Converting a SAS date or datetime to javascript isn’t hard, but still - it should be easy to google for!</p>\n<p><span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtSAS=20563;</span>\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  var dtJS=new Date(+new Date(1960,0,1) + dtSAS * 86400000);</span>\n<span style=\"font-family: 'courier new' , 'courier' , monospace;\">  alert(dtJS.toUTCString());</span></p>\n<p>Right, that should get rid of 95% of readers, for the rest of you, a quick explanation.</p>\n<p>First, it’s important to note that SAS dates are stored as number of <i>days </i>since Jan 1st, 1960 - whereas Javascript “dates” are actually the number of <i>milliseconds </i>since Jan 1st 1970.  This explains the <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">86400000 </span>value (24 days _ 60 minutes _ 60 seconds * 1000 milliseconds), and why the embedded <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Date() </span>object is set to 1960.</p>\n<p>Next, there’s the ”+” sign before that nested Date object.  That tells Javascript to return a numeric value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">-315619200000</span>) instead of a formatted value (<span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: xx-small;\">Fri Jan 01 1960 00:00:00 GMT+0000 (GMT Standard Time)</span>).</p>\n<p>Finally, the .toUTCString() method avoids contention with local time conventions (eg the extra 1 hour in BST).</p>\n<p>To make this even easier to deal with, I’ve knocked together a simple Javascript function - see <a href=\"https://jsfiddle.net/rawsas/bzskug3d/\" target=\"_blank\" rel=\"noopener\">fiddle</a>.</p>\n<div style=\"clear: both; text-align: center;\"></div>\n<span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// valid in ECMASCRIPT 2016</span>\n<span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">function</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAS</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">=</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// accepts SAS unformatted DATE or DATETIME</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// dtType should be used to determine the above</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// -315619200000 is equivalent to +new Date(1960,0,1)</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #006600; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">// 86400000 is equivalent to 24h * 60m * 60s * 1000ms</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">86400000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">if</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtType</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">===</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">new</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">Date</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">-</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">315619200000</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtSAS </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">*</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1000</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">else</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">{</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    console.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">log</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'Unknown dtType value - '</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">+</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> dtType</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">    </span><span style=\"color: #000066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">return</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\"> </span><span style=\"color: #003366; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; font-weight: bold; line-height: 14.8104px; white-space: nowrap;\">null</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">  </span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span>\n<span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">}</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">20578</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATE'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">alert</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">dtSAStoJS</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #cc0000; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">1776743820</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">,</span><span style=\"color: #3366cc; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">'DATETIME'</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"background-color: #f0f0f0; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">.</span><span style=\"color: #660066; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">toUTCString</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">(</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #009900; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">)</span><span style=\"color: #339933; font-family: 'courier new' , 'courier' , monospace; font-size: 13.464px; line-height: 14.8104px; white-space: nowrap;\">;</span>\n<p>If this post was useful, then do also check out <a href=\"/tetrahex-rawsas/building-web-apps-with-sas\">How To Build Web Apps With SAS</a>.</p>\n<p>And in case you were wondering - datetime <span style=\"font-family: 'courier new' , 'courier' , monospace; font-size: x-small;\">1776743820 </span>(GMT) was when Dr Goodnight officially <a href=\"http://www.linkedin.com/hp/update/6128386230842384384\" target=\"_blank\" rel=\"noopener\">announced </a>SAS Viya!</p>","frontmatter":{"title":"Converting SAS date to Javascript datetime (in Javascript)","path":"/converting-sas-date-to-javascript-date-in-javascript/","previewImg":null,"tags":["SQL"],"date":"May 04, 2016"}}},{"post":{"html":"<p>Thought I’d write this one up as the exact error message didn’t appear on google.  Of course, the sharp eyed among you will quickly spot the missing security / authorisation info..<br /><br /><br /><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15         LIBNAME myLib OLEDB PROPERTIES=(‘initial catalog’=MyCat) DATASOURCE=‘MySvr’ PROVIDER=SQLNCLIxx.x SCHEMA=dbo</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">15       ! connection=shared;</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error trying to establish connection: Unable to Initialize: Invalid authorization specification</span></div><br /><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\">ERROR: Error in the LIBNAME statement.</span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background: white; color: red; font-family: &quot;Courier New&quot;;\"><br /></span></div><div><span style=\"background-color: white;\">The fix was to provide a valid connection string, eg as follows (in this particular case):</span></div><div><span style=\"background-color: white;\"><br /></span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">LIBNAME</span><span style=\"background: white; font-family: 'Courier New';\"> myLib </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">OLEDB</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROPERTIES</span><span style=\"background: white; font-family: 'Courier New';\">=(</span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Integrated Security’</span><span style=\"background: white; font-family: 'Courier New';\">=SSPI </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘Persist Security Info’</span><span style=\"background: white; font-family: 'Courier New';\">=True </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">              </span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘initial catalog’</span><span style=\"background: white; font-family: 'Courier New';\">=MyCat) </span></div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">DATASOURCE</span><span style=\"background: white; font-family: 'Courier New';\">=</span><span style=\"background: white; color: purple; font-family: &quot;Courier New&quot;;\">‘MySrv’</span><span style=\"background: white; font-family: 'Courier New';\"> </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">PROVIDER</span><span style=\"background: white; font-family: 'Courier New';\">=SQLNCLIxx.x  </span></div><div> </div><div style=\"margin-bottom: 0.0001pt;\"><span style=\"background: white; font-family: 'Courier New';\">  </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">SCHEMA</span><span style=\"background: white; font-family: 'Courier New';\">=dbo </span><span style=\"background: white; color: blue; font-family: &quot;Courier New&quot;;\">connection</span><span style=\"background: white; font-family: 'Courier New';\">=shared;</span></div><div><span style=\"background-color: white;\"><br /></span></div><div><span style=\"background-color: white;\">Given that this libname statement was being built <a href=\"https://github.com/sashub/macro/blob/master/standalone/assign_direct_lib.sas\" target=\"_blank\">dynamically</a> from metadata, it was necessary to stick those properties into the server definition, as follows:</span></div><div></div><ol><li>Open SMC</li><li>Expand Server Manager</li><li>Expand the relevant Server (as specified in the Library definition)</li><li>In the properties of the underlying Connection, select the Options tab</li><li>Select OLE DB Connection Information Options</li><li>Stick in the relevant properties as per the libname statement, <i>including brackets</i>.</li></ol></p>","frontmatter":{"title":"Error trying to establish connection: Unable to Initialize: Invalid authorization specification","path":"/error-trying-to-establish-connection-unable-to-initialize-invalid-authorization-specification/","previewImg":null,"tags":["SQL"],"date":"Jan 23, 2016"}}}]}},"pageContext":{"page":"category","archives":{"2012":8,"2013":10,"2014":4,"2015":7,"2016":17,"2017":12,"2018":9,"2019":2,"2020":3},"filter":{"frontmatter":{"tags":{"in":["SQL"]}}},"limit":10,"skip":10,"numPages":5,"currentPage":2,"tag":"SQL"}},"staticQueryHashes":[]}